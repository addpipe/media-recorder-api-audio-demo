<!DOCTYPE html>
<html>
  <head><title>Simple MediaRecorder API audio recording demo</title></head>
  <body>
  	<button id="recordButton">Record/Stop</button>
    <script>
      var recorder, gumStream;
      var recordButton = document.getElementById("recordButton");
      recordButton.addEventListener("click", toggleRecording);
      function toggleRecording() {
        if (recorder && recorder.state=="recording"){
          recorder.stop();
          gumStream.getAudioTracks()[0].stop();
        }else{
          navigator.mediaDevices.getUserMedia({audio: true}).then(function(stream) {
            gumStream = stream;
            recorder = new MediaRecorder(stream);
            recorder.ondataavailable = function(e){
              var url = URL.createObjectURL(e.data);
              var preview = document.createElement('audio');
              preview.controls = true;preview.src = url;
              document.body.appendChild(preview);
            };
            recorder.start();
          });
        }
      }
    </script>
  </body>
</html>